

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Oil & Gas Industry Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#00bcd4; --glass: rgba(255,255,255,0.03);
      --success:#16a34a; --danger:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; background:linear-gradient(180deg,#061021 0%, #071428 100%); color:#dbe7f0;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .container{max-width:1200px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;gap:16px;margin-bottom:20px}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#4dd0e1);display:flex;align-items:center;justify-content:center;color:#04202a;font-weight:700;font-size:18px}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    /* cards grid */
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 20px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.02)}
    .stat-card{grid-column:span 3;min-height:84px;display:flex;flex-direction:column;justify-content:center}
    .stat-title{font-size:12px;color:var(--muted)}
    .stat-value{font-size:20px;font-weight:700;margin-top:6px}

    /* charts */
    .chart-card{grid-column:span 8;padding:18px}
    .chart-desc{grid-column:span 8;padding:18px; text-align: justify; text-justify: inter-word;}
    .side-card{grid-column:span 4;padding:18px}
    .full-card{grid-column:1/-1;padding:18px}

    /* controls */
    .controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    select,input[type=range]{background:var(--glass);border:1px solid rgba(255,255,255,0.03);color:inherit;padding:8px;border-radius:8px}
    button{background:linear-gradient(90deg,var(--accent),#4dd0e1);border:none;padding:8px 12px;border-radius:8px;color:#04202a;font-weight:600;cursor:pointer}
    .muted{color:var(--muted);font-size:13px}
    footer{color:var(--muted);margin-top:18px;font-size:13px}

    @media (max-width:900px){
      .stat-card{grid-column:span 6}
      .chart-card{grid-column:span 12}
      .side-card{grid-column:span 12}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">OG</div>
      <div>
        <h1>Oil &amp; Gas Industry Dashboard — Static</h1>
        <p class="lead">Interactive static site with sample data, charts and export tools. Replace the sample data with your own CSV/JSON to display real metrics.</p>
      </div>
    </header>

    <section class="grid" style="margin-bottom:12px">

      <div class="card stat-card">
        <div class="stat-title">Active Rigs</div>
        <div id="activeRigs" class="stat-value">—</div>
        <div class="muted">Operational rigs this month</div>
      </div>

      <div class="card stat-card">
        <div class="stat-title">Evolution (%)</div>
        <div id="activeRigs_YoY" class="stat-value">—</div>
        <div class="muted">Year-to-date</div>
      </div>

      <div class="card stat-card">
        <div class="stat-title">Average Oil Price (USD)</div>
        <div id="avgPrice" class="stat-value">—</div>
        <div class="muted">Brent — Monthly average</div>
      </div>

      <div class="card stat-card">
        <div class="stat-title">Estimated Reserves (Bboe)</div>
        <div id="reserves" class="stat-value">—</div>
        <div class="muted">Proven</div>
      </div>
    </section>

    <section class="grid" style="align-items:start">
      
        <div style="grid-column:span 8">
        <div class="card chart-desc">
            <div>
                The global active rig count shows a clear cyclical pattern over the past decade, with a strong recovery from the 2020 collapse followed by a gradual slowdown starting in mid-2023. After peaking near 1,900 rigs in early 2023, activity has steadily softened as investment and drilling momentum cooled across several regions. Throughout 2024 and into 2025, the numbers continue drifting downward, reflecting a more cautious operating environment and uneven demand signals. The most recent data point — 1,619 rigs in July 2025 — reinforces this trend, marking a continued step back from the highs of the post-pandemic rebound. While far above the 2020 lows, the latest figure suggests that the industry is settling into a slower expansion phase, with operators prioritizing efficiency and capital discipline over aggressive rig deployment.
            
                <i>Source: <a class="muted" href="https://rigcount.bakerhughes.com/">Baker Hughes</a></i>
            </div>
        
        </div>

      <div class="card chart-card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
          <div>
            <strong>World active rig (Monthly)</strong>
            <div class="muted">Baker Hughes Rig Count Overview</div>
          </div>
          <div class="controls">
            <button id="exportCsv">Export CSV</button>
          </div>
        </div>
        <div style="margin-bottom:6px" class="controls">
            <button id="filter1Y" class="button">1Y</button>
            <button id="filter5Y" class="button">5Y</button>
            <button id="filter10Y" class="button">10Y</button>
            <button id="filter25Y" class="button">25Y</button>
            <button id="filterAll" class="button">∞</button>
          </div>
        <div>
            <canvas id="rigChart" height="350"></canvas>
        </div>
      </div>
      </div>

      <div class="card side-card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
          <div>
            <strong>Revenue by Segment</strong>
            <div class="muted">Upstream / Midstream / Downstream</div>
          </div>
          <div class="muted">USD millions</div>
        </div>
        
        <div>
            <canvas id="revenueChart" height="160"></canvas>
        </div>

        <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0">
        <strong>Reserves Mix</strong>
        <div class="muted" style="margin-bottom:8px">Crude, Natural Gas, Condensates</div>
         <div>
        <canvas id="reservesChart" height="120"></canvas>
        </div>
      </div>

      <div class="card full-card">
        <strong>Data Table</strong>
        <div class="muted" style="margin:8px 0 12px">Monthly sample dataset used for charts. Use the Export CSV button to download.</div>
        <div style="overflow:auto;max-height:220px;border-radius:8px;padding:6px;background:rgba(255,255,255,0.01)">
          <table id="dataTable" style="width:100%;border-collapse:collapse;font-size:13px">
            <thead style="position:sticky;top:0;background:transparent;color:var(--muted)">
              <tr>
                <th style="text-align:left;padding:8px">Date</th>
                <th style="text-align:right;padding:8px">World active rigs</th>
                <th style="text-align:right;padding:8px">YoY (%)</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <footer>Static demo • Charts powered by Chart.js • Replace <code>sampleData</code> in the script with your dataset</footer>
  </div>
<script id="dataset" type="application/json">{
 "header":["DateTime", "YoY_what=rig_count", "what=rig_count"],
 "data":[
["1975-01-31", null, 2694.0],
["1975-02-28", null, 2718.0],
["1975-03-31", null, 2769.0],
["1975-04-30", null, 2593.0],
["1975-05-31", null, 2557.0],
["1975-06-30", null, 2650.0],
["1975-07-31", null, 2670.0],
["1975-08-31", null, 2711.0],
["1975-09-30", null, 2743.0],
["1975-10-31", null, 2801.0],
["1975-11-30", null, 2853.0],
["1975-12-31", null, 2899.0],
["1976-01-31", 6.57, 2871.0],
["1976-02-29", 1.73, 2765.0],
["1976-03-31", -2.53, 2699.0],
["1976-04-30", -3.16, 2511.0],
["1976-05-31", 0.82, 2578.0],
["1976-06-30", 1.81, 2698.0],
["1976-07-31", 1.99, 2723.0],
["1976-08-31", 5.05, 2848.0],
["1976-09-30", 5.29, 2888.0],
["1976-10-31", 4.82, 2936.0],
["1976-11-30", 4.31, 2976.0],
["1976-12-31", 3.93, 3013.0],
["1977-01-31", 5.64, 3033.0],
["1977-02-28", 11.93, 3095.0],
["1977-03-31", 15.71, 3123.0],
["1977-04-30", 19.95, 3012.0],
["1977-05-31", 20.17, 3098.0],
["1977-06-30", 17.94, 3182.0],
["1977-07-31", 18.73, 3233.0],
["1977-08-31", 16.47, 3317.0],
["1977-09-30", 14.72, 3313.0],
["1977-10-31", 14.2, 3353.0],
["1977-11-30", 14.18, 3398.0],
["1977-12-31", 14.3, 3444.0],
["1978-01-31", 12.2, 3403.0],
["1978-02-28", 11.53, 3452.0],
["1978-03-31", 11.62, 3486.0],
["1978-04-30", 13.65, 3423.0],
["1978-05-31", 13.2, 3507.0],
["1978-06-30", 13.29, 3605.0],
["1978-07-31", 13.42, 3667.0],
["1978-08-31", 11.91, 3712.0],
["1978-09-30", 11.71, 3701.0],
["1978-10-31", 11.48, 3738.0],
["1978-11-30", 11.83, 3800.0],
["1978-12-31", 8.51, 3737.0],
["1979-01-31", 6.08, 3610.0],
["1979-02-28", 1.97, 3520.0],
["1979-03-31", -2.21, 3409.0],
["1979-04-30", -4.44, 3271.0],
["1979-05-31", -6.76, 3270.0],
["1979-06-30", -4.69, 3436.0],
["1979-07-31", -2.78, 3565.0],
["1979-08-31", 1.0, 3749.0],
["1979-09-30", 4.43, 3865.0],
["1979-10-31", 6.02, 3963.0],
["1979-11-30", 7.11, 4070.0],
["1979-12-31", 11.75, 4176.0],
["1980-01-31", 15.1, 4155.0],
["1980-02-29", 21.45, 4275.0],
["1980-03-31", 26.66, 4318.0],
["1980-04-30", 30.57, 4271.0],
["1980-05-31", 35.84, 4442.0],
["1980-06-30", 31.96, 4534.0],
["1980-07-31", 31.11, 4674.0],
["1980-08-31", 27.93, 4796.0],
["1980-09-30", 25.1, 4835.0],
["1980-10-31", 23.77, 4905.0],
["1980-11-30", 22.58, 4989.0],
["1980-12-31", 20.62, 5037.0],
["1981-01-31", 22.86, 5105.0],
["1981-02-28", 24.19, 5309.0],
["1981-03-31", 24.64, 5382.0],
["1981-04-30", 23.32, 5267.0],
["1981-05-31", 20.62, 5358.0],
["1981-06-30", 21.64, 5515.0],
["1981-07-31", 19.92, 5605.0],
["1981-08-31", 19.89, 5750.0],
["1981-09-30", 21.72, 5885.0],
["1981-10-31", 22.22, 5995.0],
["1981-11-30", 22.13, 6093.0],
["1981-12-31", 23.63, 6227.0],
["1982-01-31", 20.43, 6148.0],
["1982-02-28", 12.36, 5965.0],
["1982-03-31", 3.85, 5589.0],
["1982-04-30", -4.4, 5035.0],
["1982-05-31", -11.52, 4741.0],
["1982-06-30", -18.17, 4513.0],
["1982-07-31", -22.39, 4350.0],
["1982-08-31", -26.5, 4226.0],
["1982-09-30", -30.54, 4088.0],
["1982-10-31", -32.64, 4038.0],
["1982-11-30", -30.08, 4260.0],
["1982-12-31", -27.91, 4489.0],
["1983-01-31", -30.4, 4279.0],
["1983-02-28", -36.19, 3806.0],
["1983-03-31", -36.46, 3551.0],
["1983-04-30", -36.39, 3203.0],
["1983-05-31", -30.92, 3275.0],
["1983-06-30", -23.8, 3439.0],
["1983-07-31", -19.54, 3500.0],
["1983-08-31", -13.49, 3656.0],
["1983-09-30", -9.34, 3706.0],
["1983-10-31", -5.92, 3799.0],
["1983-11-30", -5.85, 4011.0],
["1983-12-31", -4.88, 4270.0],
["1984-01-31", -3.41, 4133.0],
["1984-02-29", 4.34, 3971.0],
["1984-03-31", 6.7, 3789.0],
["1984-04-30", 7.84, 3454.0],
["1984-05-31", 11.6, 3655.0],
["1984-06-30", 10.5, 3800.0],
["1984-07-31", 10.23, 3858.0],
["1984-08-31", 7.44, 3928.0],
["1984-09-30", 5.53, 3911.0],
["1984-10-31", 5.16, 3995.0],
["1984-11-30", 4.06, 4174.0],
["1984-12-31", 1.43, 4331.0],
["1985-01-31", -2.01, 4050.0],
["1985-02-28", -3.4, 3836.0],
["1985-03-31", -4.72, 3610.0],
["1985-04-30", -5.01, 3281.0],
["1985-05-31", -9.44, 3310.0],
["1985-06-30", -9.08, 3455.0],
["1985-07-31", -8.86, 3516.0],
["1985-08-31", -9.73, 3546.0],
["1985-09-30", -10.33, 3507.0],
["1985-10-31", -13.29, 3464.0],
["1985-11-30", -14.95, 3550.0],
["1985-12-31", -16.46, 3618.0],
["1986-01-31", -13.7, 3495.0],
["1986-02-28", -18.59, 3123.0],
["1986-03-31", -25.73, 2681.0],
["1986-04-30", -34.65, 2144.0],
["1986-05-31", -41.45, 1938.0],
["1986-06-30", -46.43, 1851.0],
["1986-07-31", -49.6, 1772.0],
["1986-08-31", -48.59, 1823.0],
["1986-09-30", -47.93, 1826.0],
["1986-10-31", -45.06, 1903.0],
["1986-11-30", -44.87, 1957.0],
["1986-12-31", -41.07, 2132.0],
["1987-01-31", -39.2, 2125.0],
["1987-02-28", -38.87, 1909.0],
["1987-03-31", -29.54, 1889.0],
["1987-04-30", -16.88, 1782.0],
["1987-05-31", -7.89, 1785.0],
["1987-06-30", 1.51, 1879.0],
["1987-07-31", 14.39, 2027.0],
["1987-08-31", 18.82, 2166.0],
["1987-09-30", 27.93, 2336.0],
["1987-10-31", 25.91, 2396.0],
["1987-11-30", 25.75, 2461.0],
["1987-12-31", 13.09, 2411.0],
["1988-01-31", 7.44, 2283.0],
["1988-02-29", 21.16, 2313.0],
["1988-03-31", 21.81, 2301.0],
["1988-04-30", 15.15, 2052.0],
["1988-05-31", 15.57, 2063.0],
["1988-06-30", 12.51, 2114.0],
["1988-07-31", 4.64, 2121.0],
["1988-08-31", -1.02, 2144.0],
["1988-09-30", -5.05, 2218.0],
["1988-10-31", -10.48, 2145.0],
["1988-11-30", -11.21, 2185.0],
["1988-12-31", -15.76, 2031.0],
["1989-01-31", -14.37, 1955.0],
["1989-02-28", -15.39, 1957.0],
["1989-03-31", -16.6, 1919.0],
["1989-04-30", -12.18, 1802.0],
["1989-05-31", -15.9, 1735.0],
["1989-06-30", -15.47, 1787.0],
["1989-07-31", -13.63, 1832.0],
["1989-08-31", -12.97, 1866.0],
["1989-09-30", -12.04, 1951.0],
["1989-10-31", -5.83, 2020.0],
["1989-11-30", -4.85, 2079.0],
["1989-12-31", 4.73, 2127.0],
["1990-01-31", 6.04, 2073.0],
["1990-02-28", 4.7, 2049.0],
["1990-03-31", 7.03, 2054.0],
["1990-04-30", 8.05, 1947.0],
["1990-05-31", 13.2, 1964.0],
["1990-06-30", 13.99, 2037.0],
["1990-07-31", 10.75, 2029.0],
["1990-08-31", 6.48, 1987.0],
["1990-09-30", 2.72, 2004.0],
["1990-10-31", 2.43, 2069.0],
["1990-11-30", 5.92, 2202.0],
["1990-12-31", 4.09, 2214.0],
["1991-01-31", 3.28, 2141.0],
["1991-02-28", 1.71, 2084.0],
["1991-03-31", -0.44, 2045.0],
["1991-04-30", -5.55, 1839.0],
["1991-05-31", -9.06, 1786.0],
["1991-06-30", -8.3, 1868.0],
["1991-07-31", -8.28, 1861.0],
["1991-08-31", -8.3, 1822.0],
["1991-09-30", -12.43, 1755.0],
["1991-10-31", -11.99, 1821.0],
["1991-11-30", -16.08, 1848.0],
["1991-12-31", -17.3, 1831.0],
["1992-01-31", -18.59, 1743.0],
["1992-02-29", -18.71, 1694.0],
["1992-03-31", -21.03, 1615.0],
["1992-04-30", -15.77, 1549.0],
["1992-05-31", -12.82, 1557.0],
["1992-06-30", -16.92, 1552.0],
["1992-07-31", -13.16, 1616.0],
["1992-08-31", -10.81, 1625.0],
["1992-09-30", -7.41, 1625.0],
["1992-10-31", -5.49, 1721.0],
["1992-11-30", 0.27, 1853.0],
["1992-12-31", 3.66, 1898.0],
["1993-01-31", 1.03, 1761.0],
["1993-02-28", -0.47, 1686.0],
["1993-03-31", 0.43, 1622.0],
["1993-04-30", -4.26, 1483.0],
["1993-05-31", -2.06, 1525.0],
["1993-06-30", 6.38, 1651.0],
["1993-07-31", 3.22, 1668.0],
["1993-08-31", 6.58, 1732.0],
["1993-09-30", 10.46, 1795.0],
["1993-10-31", 7.32, 1847.0],
["1993-11-30", 1.51, 1881.0],
["1993-12-31", -0.9, 1881.0],
["1994-01-31", 5.45, 1857.0],
["1994-02-28", 8.3, 1826.0],
["1994-03-31", 7.15, 1738.0],
["1994-04-30", 7.48, 1594.0],
["1994-05-31", 5.57, 1610.0],
["1994-06-30", 3.94, 1716.0],
["1994-07-31", 5.16, 1754.0],
["1994-08-31", 1.33, 1755.0],
["1994-09-30", 1.62, 1824.0],
["1994-10-31", -1.19, 1825.0],
["1994-11-30", -0.27, 1876.0],
["1994-12-31", -2.5, 1834.0],
["1995-01-31", -1.13, 1836.0],
["1995-02-28", 0.0, 1826.0],
["1995-03-31", -2.47, 1695.0],
["1995-04-30", -4.58, 1521.0],
["1995-05-31", -3.66, 1551.0],
["1995-06-30", -1.81, 1685.0],
["1995-07-31", -2.17, 1716.0],
["1995-08-31", -2.56, 1710.0],
["1995-09-30", -4.5, 1742.0],
["1995-10-31", -5.7, 1721.0],
["1995-11-30", -6.88, 1747.0],
["1995-12-31", -2.02, 1797.0],
["1996-01-31", -0.49, 1827.0],
["1996-02-29", 0.82, 1841.0],
["1996-03-31", 7.32, 1819.0],
["1996-04-30", 6.51, 1620.0],
["1996-05-31", 8.12, 1677.0],
["1996-06-30", 7.54, 1812.0],
["1996-07-31", 10.14, 1890.0],
["1996-08-31", 10.29, 1886.0],
["1996-09-30", 6.77, 1860.0],
["1996-10-31", 10.52, 1902.0],
["1996-11-30", 12.08, 1958.0],
["1996-12-31", 11.57, 2005.0],
["1997-01-31", 11.22, 2032.0],
["1997-02-28", 12.28, 2067.0],
["1997-03-31", 13.63, 2067.0],
["1997-04-30", 18.15, 1914.0],
["1997-05-31", 17.41, 1969.0],
["1997-06-30", 17.05, 2121.0],
["1997-07-31", 14.71, 2168.0],
["1997-08-31", 17.44, 2215.0],
["1997-09-30", 18.87, 2211.0],
["1997-10-31", 16.93, 2224.0],
["1997-11-30", 13.89, 2230.0],
["1997-12-31", 15.61, 2318.0],
["1998-01-31", 12.84, 2293.0],
["1998-02-28", 10.79, 2290.0],
["1998-03-31", 2.95, 2128.0],
["1998-04-30", -4.96, 1819.0],
["1998-05-31", -8.08, 1810.0],
["1998-06-30", -11.27, 1882.0],
["1998-07-31", -18.63, 1764.0],
["1998-08-31", -22.12, 1725.0],
["1998-09-30", -23.43, 1693.0],
["1998-10-31", -29.27, 1573.0],
["1998-11-30", -29.24, 1578.0],
["1998-12-31", -32.44, 1566.0],
["1999-01-31", -31.84, 1563.0],
["1999-02-28", -35.11, 1486.0],
["1999-03-31", -37.17, 1337.0],
["1999-04-30", -36.45, 1156.0],
["1999-05-31", -35.3, 1171.0],
["1999-06-30", -28.43, 1347.0],
["1999-07-31", -21.54, 1384.0],
["1999-08-31", -15.07, 1465.0],
["1999-09-30", -9.75, 1528.0],
["1999-10-31", 1.4, 1595.0],
["1999-11-30", 7.29, 1693.0],
["1999-12-31", 12.2, 1757.0],
["2000-01-31", 17.53, 1837.0],
["2000-02-29", 25.77, 1869.0],
["2000-03-31", 32.61, 1773.0],
["2000-04-30", 34.34, 1553.0],
["2000-05-31", 41.76, 1660.0],
["2000-06-30", 35.56, 1826.0],
["2000-07-31", 38.15, 1912.0],
["2000-08-31", 37.27, 2011.0],
["2000-09-30", 33.44, 2039.0],
["2000-10-31", 33.86, 2135.0],
["2000-11-30", 25.75, 2129.0],
["2000-12-31", 25.9, 2212.0],
["2001-01-31", 29.23, 2374.0],
["2001-02-28", 30.02, 2430.0],
["2001-03-31", 31.47, 2331.0],
["2001-04-30", 39.41, 2165.0],
["2001-05-31", 33.98, 2224.0],
["2001-06-30", 27.77, 2333.0],
["2001-07-31", 22.65, 2345.0],
["2001-08-31", 16.01, 2333.0],
["2001-09-30", 11.62, 2276.0],
["2001-10-31", 1.41, 2165.0],
["2001-11-30", -5.73, 2007.0],
["2001-12-31", -13.34, 1917.0],
["2002-01-31", -15.08, 2016.0],
["2002-02-28", -18.77, 1974.0],
["2002-03-31", -22.44, 1808.0],
["2002-04-30", -26.24, 1597.0],
["2002-05-31", -25.45, 1658.0],
["2002-06-30", -23.79, 1778.0],
["2002-07-31", -22.3, 1822.0],
["2002-08-31", -22.63, 1805.0],
["2002-09-30", -19.29, 1837.0],
["2002-10-31", -16.03, 1818.0],
["2002-11-30", -6.58, 1875.0],
["2002-12-31", 2.09, 1957.0],
["2003-01-31", 2.48, 2066.0],
["2003-02-28", 12.11, 2213.0],
["2003-03-31", 18.2, 2137.0],
["2003-04-30", 19.22, 1904.0],
["2003-05-31", 17.01, 1940.0],
["2003-06-30", 20.58, 2144.0],
["2003-07-31", 23.71, 2254.0],
["2003-08-31", 25.93, 2273.0],
["2003-09-30", 21.56, 2233.0],
["2003-10-31", 25.74, 2286.0],
["2003-11-30", 22.88, 2304.0],
["2003-12-31", 19.26, 2334.0],
["2004-01-31", 18.93, 2457.0],
["2004-02-29", 11.93, 2477.0],
["2004-03-31", 12.17, 2397.0],
["2004-04-30", 12.18, 2136.0],
["2004-05-31", 12.89, 2190.0],
["2004-06-30", 6.44, 2282.0],
["2004-07-31", 5.63, 2381.0],
["2004-08-31", 7.48, 2443.0],
["2004-09-30", 6.54, 2379.0],
["2004-10-31", 7.35, 2454.0],
["2004-11-30", 12.2, 2585.0],
["2004-12-31", 9.47, 2555.0],
["2005-01-31", 8.47, 2665.0],
["2005-02-28", 10.82, 2745.0],
["2005-03-31", 9.18, 2617.0],
["2005-04-30", 13.06, 2415.0],
["2005-05-31", 13.47, 2485.0],
["2005-06-30", 13.06, 2580.0],
["2005-07-31", 15.88, 2759.0],
["2005-08-31", 18.46, 2894.0],
["2005-09-30", 20.05, 2856.0],
["2005-10-31", 19.11, 2923.0],
["2005-11-30", 16.87, 3021.0],
["2005-12-31", 17.14, 2993.0],
["2006-01-31", 14.0, 3038.0],
["2006-02-28", 14.13, 3133.0],
["2006-03-31", 17.27, 3069.0],
["2006-04-30", 12.09, 2707.0],
["2006-05-31", 12.47, 2795.0],
["2006-06-30", 15.47, 2979.0],
["2006-07-31", 14.35, 3155.0],
["2006-08-31", 9.68, 3174.0],
["2006-09-30", 9.73, 3134.0],
["2006-10-31", 7.08, 3130.0],
["2006-11-30", 1.85, 3077.0],
["2006-12-31", 4.41, 3125.0],
["2007-01-31", 7.11, 3254.0],
["2007-02-28", 6.99, 3352.0],
["2007-03-31", 2.15, 3135.0],
["2007-04-30", 4.77, 2836.0],
["2007-05-31", 2.4, 2862.0],
["2007-06-30", 0.57, 2996.0],
["2007-07-31", -0.35, 3144.0],
["2007-08-31", -0.57, 3156.0],
["2007-09-30", 1.02, 3166.0],
["2007-10-31", -0.19, 3124.0],
["2007-11-30", 2.73, 3161.0],
["2007-12-31", 2.62, 3207.0],
["2008-01-31", 1.29, 3296.0],
["2008-02-29", 1.94, 3417.0],
["2008-03-31", 3.96, 3259.0],
["2008-04-30", 6.1, 3009.0],
["2008-05-31", 7.37, 3073.0],
["2008-06-30", 9.11, 3269.0],
["2008-07-31", 9.29, 3436.0],
["2008-08-31", 11.63, 3523.0],
["2008-09-30", 12.35, 3557.0],
["2008-10-31", 12.61, 3518.0],
["2008-11-30", 9.08, 3448.0],
["2008-12-31", 0.44, 3221.0],
["2009-01-31", -9.77, 2974.0],
["2009-02-28", -19.43, 2753.0],
["2009-03-31", -29.03, 2313.0],
["2009-04-30", -31.7, 2055.0],
["2009-05-31", -35.47, 1983.0],
["2009-06-30", -39.22, 1987.0],
["2009-07-31", -39.46, 2080.0],
["2009-08-31", -40.25, 2105.0],
["2009-09-30", -38.07, 2203.0],
["2009-10-31", -35.45, 2271.0],
["2009-11-30", -30.13, 2409.0],
["2009-12-31", -22.1, 2509.0],
["2010-01-31", -6.76, 2773.0],
["2010-02-28", 8.32, 2982.0],
["2010-03-31", 24.47, 2879.0],
["2010-04-30", 30.22, 2676.0],
["2010-05-31", 38.68, 2750.0],
["2010-06-30", 43.89, 2859.0],
["2010-07-31", 45.77, 3032.0],
["2010-08-31", 48.55, 3127.0],
["2010-09-30", 41.72, 3122.0],
["2010-10-31", 39.37, 3165.0],
["2010-11-30", 34.21, 3233.0],
["2010-12-31", 28.62, 3227.0],
["2011-01-31", 23.91, 3436.0],
["2011-02-28", 18.58, 3536.0],
["2011-03-31", 19.28, 3434.0],
["2011-04-30", 15.96, 3103.0],
["2011-05-31", 13.82, 3130.0],
["2011-06-30", 13.92, 3257.0],
["2011-07-31", 12.04, 3397.0],
["2011-08-31", 15.54, 3613.0],
["2011-09-30", 17.3, 3662.0],
["2011-10-31", 17.6, 3722.0],
["2011-11-30", 13.92, 3683.0],
["2011-12-31", 11.93, 3612.0],
["2012-01-31", 9.17, 3751.0],
["2012-02-29", 10.29, 3900.0],
["2012-03-31", 6.67, 3663.0],
["2012-04-30", 6.28, 3298.0],
["2012-05-31", 6.55, 3335.0],
["2012-06-30", 6.97, 3484.0],
["2012-07-31", 3.5, 3516.0],
["2012-08-31", -3.4, 3490.0],
["2012-09-30", -5.3, 3468.0],
["2012-10-31", -7.09, 3458.0],
["2012-11-30", -6.03, 3461.0],
["2012-12-31", -6.15, 3390.0],
["2013-01-31", -5.68, 3538.0],
["2013-02-28", -5.67, 3678.75],
["2013-03-31", -4.78, 3488.0],
["2013-04-30", -2.71, 3208.75],
["2013-05-31", -4.72, 3177.5999],
["2013-06-30", -5.96, 3276.5],
["2013-07-31", -4.42, 3360.75],
["2013-08-31", -2.14, 3415.4],
["2013-09-30", -1.07, 3430.75],
["2013-10-31", -0.62, 3436.5],
["2013-11-30", -0.24, 3452.5999],
["2013-12-31", 2.59, 3477.75],
["2014-01-31", 1.7, 3598.1997],
["2014-02-28", 1.54, 3735.5],
["2014-03-31", 3.13, 3597.25],
["2014-04-30", 5.58, 3387.75],
["2014-05-31", 6.09, 3371.2],
["2014-06-30", 5.14, 3445.0],
["2014-07-31", 7.35, 3607.75],
["2014-08-31", 6.63, 3641.8003],
["2014-09-30", 6.65, 3658.75],
["2014-10-31", 6.43, 3657.6],
["2014-11-30", 6.29, 3669.75],
["2014-12-31", 1.28, 3522.4],
["2015-01-31", -7.83, 3316.5],
["2015-02-28", -20.06, 2986.0],
["2015-03-31", -28.99, 2554.5],
["2015-04-30", -33.08, 2267.0],
["2015-05-31", -36.89, 2127.6],
["2015-06-30", -38.02, 2135.25],
["2015-07-31", -39.92, 2167.4001],
["2015-08-31", -38.9, 2225.25],
["2015-09-30", -40.68, 2170.5],
["2015-10-31", -42.97, 2085.7998],
["2015-11-30", -44.23, 2046.5],
["2015-12-31", -44.64, 1949.9999],
["2016-01-31", -42.53, 1906.0],
["2016-02-29", -41.02, 1761.25],
["2016-03-31", -39.32, 1550.0],
["2016-04-30", -37.18, 1424.2],
["2016-05-31", -34.02, 1403.75],
["2016-06-30", -34.13, 1406.5],
["2016-07-31", -31.66, 1481.2],
["2016-08-31", -30.48, 1547.0],
["2016-09-30", -27.05, 1583.4001],
["2016-10-31", -22.34, 1619.75],
["2016-11-30", -18.08, 1676.5],
["2016-12-31", -9.14, 1771.8002],
["2017-01-31", 0.59, 1917.25],
["2017-02-28", 15.06, 2026.5],
["2017-03-31", 28.09, 1985.3998],
["2017-04-30", 34.65, 1917.75],
["2017-05-31", 37.83, 1934.75],
["2017-06-30", 45.13, 2041.2],
["2017-07-31", 42.45, 2110.0],
["2017-08-31", 36.8, 2116.25],
["2017-09-30", 31.38, 2080.2],
["2017-10-31", 28.17, 2076.0],
["2017-11-30", 22.71, 2057.25],
["2017-12-31", 17.9, 2089.0],
["2018-01-31", 13.43, 2174.75],
["2018-02-28", 12.03, 2270.25],
["2018-03-31", 9.72, 2178.4001],
["2018-04-30", 8.83, 2087.0],
["2018-05-31", 8.27, 2094.75],
["2018-06-30", 5.4, 2151.4],
["2018-07-31", 6.65, 2250.25],
["2018-08-31", 7.65, 2278.2002],
["2018-09-30", 8.54, 2257.75],
["2018-10-31", 9.42, 2271.5],
["2018-11-30", 10.19, 2266.8],
["2018-12-31", 7.35, 2242.5],
["2019-01-31", 4.1, 2264.0],
["2019-02-28", 1.52, 2304.75],
["2019-03-31", 1.56, 2212.4001],
["2019-04-30", 2.55, 2140.25],
["2019-05-31", 4.18, 2182.4001],
["2019-06-30", 3.22, 2220.75],
["2019-07-31", -0.56, 2237.75],
["2019-08-31", -3.18, 2205.8],
["2019-09-30", -5.18, 2140.75],
["2019-10-31", -6.54, 2123.0],
["2019-11-30", -9.93, 2041.7999],
["2019-12-31", -8.91, 2042.75],
["2020-01-31", -8.39, 2074.0],
["2020-02-29", -7.88, 2123.25],
["2020-03-31", -11.33, 1961.75],
["2020-04-30", -29.31, 1513.0],
["2020-05-31", -46.1, 1176.4],
["2020-06-30", -51.71, 1072.5],
["2020-07-31", -53.98, 1029.8],
["2020-08-31", -52.42, 1049.5],
["2020-09-30", -52.43, 1018.25],
["2020-10-31", -52.11, 1016.80005],
["2020-11-30", -47.4, 1074.0],
["2020-12-31", -46.28, 1097.3999],
["2021-01-31", -41.82, 1206.75],
["2021-02-28", -40.26, 1268.5],
["2021-03-31", -37.26, 1230.75],
["2021-04-30", -21.44, 1188.5999],
["2021-05-31", 7.26, 1261.75],
["2021-06-30", 23.59, 1325.5],
["2021-07-31", 33.95, 1379.4001],
["2021-08-31", 36.59, 1433.5],
["2021-09-30", 42.2, 1448.0],
["2021-10-31", 47.92, 1504.0],
["2021-11-30", 43.67, 1543.0],
["2021-12-31", 42.39, 1562.6],
["2022-01-31", 35.24, 1632.0],
["2022-02-28", 31.57, 1669.0],
["2022-03-31", 34.98, 1661.25],
["2022-04-30", 34.81, 1602.4],
["2022-05-31", 29.03, 1628.0],
["2022-06-30", 28.57, 1704.25],
["2022-07-31", 28.74, 1775.8002],
["2022-08-31", 27.31, 1825.0],
["2022-09-30", 27.87, 1851.6],
["2022-10-31", 25.78, 1891.75],
["2022-11-30", 22.47, 1889.75],
["2022-12-31", 17.42, 1834.7998],
["2023-01-31", 16.38, 1899.25],
["2023-02-28", 15.1, 1921.0],
["2023-03-31", 13.07, 1878.3999],
["2023-04-30", 12.82, 1807.75],
["2023-05-31", 9.47, 1782.25],
["2023-06-30", 5.58, 1799.4],
["2023-07-31", 2.4, 1818.5],
["2023-08-31", -2.03, 1788.0],
["2023-09-30", -4.98, 1759.3999],
["2023-10-31", -6.11, 1776.25],
["2023-11-30", -5.09, 1793.5],
["2023-12-31", -5.23, 1738.7999],
["2024-01-31", -6.12, 1783.0],
["2024-02-29", -5.65, 1812.5],
["2024-03-31", -4.57, 1792.6001],
["2024-04-30", -4.54, 1725.75],
["2024-05-31", -6.02, 1675.0],
["2024-06-30", -5.16, 1706.5],
["2024-07-31", -5.8, 1713.0],
["2024-08-31", -2.96, 1735.0],
["2024-09-30", -0.51, 1750.5],
["2024-10-31", -1.25, 1754.0],
["2024-11-30", -4.77, 1708.0001],
["2024-12-31", -4.56, 1659.5],
["2025-01-31", -4.9, 1695.6001],
["2025-02-28", -3.93, 1741.25],
["2025-03-31", -5.99, 1685.25],
["2025-04-30", -6.39, 1615.5],
["2025-05-31", -5.93, 1575.5999],
["2025-06-30", -6.27, 1599.5],
["2025-07-31", -5.36, 1621.25]]
}
</script>

  <script>
   
    var dataset = JSON.parse(document.getElementById('dataset').textContent);

    var header_idx = {}
    dataset.header.forEach((value, index) => {
        header_idx[value] = index
    });
   

   
    // DOM references for stats
    const activeRigsEl = document.getElementById('activeRigs');
    const activeRigsEvolEl = document.getElementById('activeRigs_YoY');

    const avgPriceEl = document.getElementById('avgPrice');
    const reservesEl = document.getElementById('reserves');

      

    // table body
    const tableBody = document.getElementById('tableBody');



    // Helper to compute aggregates for a given year
    function aggregatesForYear(from_date, to_date){
      const rows = dataset.data.filter(r => {
        date = new Date(r[header_idx['DateTime']]);
        return date >= from_date && date < to_date;
    });
      const rigs = rows.length ? rows[rows.length-1][header_idx['what=rig_count']] : 0; // last month rigs
      const rigsEvol = rows.length ? rows[rows.length-1][header_idx['YoY_what=rig_count']] : 0; // last month rigs

      const totalProd = rows.reduce((s,r)=>s + r[1],0);
      const avgPrice = rows.length ? (rows.reduce((s,r)=>s + r[2],0) / rows.length) : 0;
      const reserves = 24.7; // dummy static reserves value (Bboe) - replace as needed

      return {rows, rigs, rigsEvol, totalProd,avgPrice, reserves};
    }

    // ---------- CHARTS ----------
    const rigCtx = document.getElementById('rigChart');
    const revenueCtx = document.getElementById('revenueChart');
    const reservesCtx = document.getElementById('reservesChart');

    

    const rigChart = new Chart(rigCtx, {
      type: 'bar',
      data: {labels: [], datasets: []},
      options: {
        responsive:true, 
        maintainAspectRatio:false,
        scales:{
          y:{beginAtZero:true}
        },
        plugins:{legend:{display:true}}
      }
    });

    

    
    const revenueChart = new Chart(revenueCtx, {
      type: 'bar',
      data: {labels: ['Upstream','Midstream','Downstream'], datasets:[{label:'Revenue (USD m)',data:[0,0,0]}]},
      options:{
        responsive:true,
        maintainAspectRatio:false,
        scales:{y:{beginAtZero:true}}}
    }); 

    const reservesChart = new Chart(reservesCtx, {
      type: 'pie',
      data:{labels:['Crude','Natural Gas','Condensates'],datasets:[{data:[0,0,0],backgroundColor:['#4dd0e1','#00bcd4','#0288d1']}]},
      options:{
        responsive:true,
        maintainAspectRatio:false
    }
    });

    function renderYear(from_date, to_date){
      const agg = aggregatesForYear(from_date, to_date);
      // Update stats
        activeRigsEl.textContent = agg.rigs;
        activeRigsEvolEl.textContent = agg.rigsEvol;


      avgPriceEl.textContent = '$' + agg.avgPrice.toFixed(2);
     
      reservesEl.textContent = agg.reserves + ' Bboe';

      // Table
      tableBody.innerHTML = '';
      const reverseRows = [...agg.rows].reverse();
      reverseRows.forEach(r => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td style="padding:8px">${r[header_idx['DateTime']]}</td>
          <td style="padding:8px;text-align:right">${r[header_idx['what=rig_count']].toFixed(0)}</td>
          <td style="padding:8px;text-align:right">${r[header_idx['YoY_what=rig_count']].toFixed(2)}</td>
        `;
        tableBody.appendChild(tr);
      });

      // Production/Price chart: dual axes
      const labels = agg.rows.map(r=>r[header_idx['DateTime']]);
      const prodData = agg.rows.map(r=>r[header_idx['what=rig_count']]);

      rigChart.data.labels = labels;
      rigChart.data.datasets = [
        {type:'line',label:'World active rigs',yAxisID:'y', data:prodData, tension:0.10, pointRadius:1, borderWidth:2, backgroundColor:'rgba(77,208,225,0.18)',borderColor:'rgba(77,208,225,0.9)'}
      ];
      rigChart.options = {
        responsive:true,
        maintainAspectRatio:false,
        scales:{
          y:{position:'left',title:{display:true,text:'Unit'},beginAtZero:false}
        }
      };
      rigChart.update();

      // Revenue chart: sum months in year
      const totalUp = agg.rows.reduce((s,r)=>s + r[3],0);
      const totalMid = agg.rows.reduce((s,r)=>s + r[4],0);
      const totalDown = agg.rows.reduce((s,r)=>s + r[5],0);
      revenueChart.data.datasets[0].data = [totalUp,totalMid,totalDown];
      revenueChart.update();

      // Reserves pie - simple static split based on heuristic (replace with real values)
      reservesChart.data.datasets[0].data = [agg.reserves * 0.6, agg.reserves * 0.3, agg.reserves * 0.1];
      reservesChart.update();
    }



    to_date = new Date();
    from_date = new Date();
    from_date = new Date(from_date.setFullYear( from_date.getFullYear() - 10 ));
    

    // initial render
    renderYear(from_date, to_date);


    document.getElementById('filter1Y').addEventListener('click',()=>{

        to_date = new Date();
        from_date = new Date();
        from_date = new Date(from_date.setFullYear( from_date.getFullYear() - 1 ));

        renderYear(from_date, to_date);
    });
    document.getElementById('filter5Y').addEventListener('click',()=>{

        to_date = new Date();
        from_date = new Date();
        from_date = new Date(from_date.setFullYear( from_date.getFullYear() - 5 ));

        renderYear(from_date, to_date);
    });
    document.getElementById('filter10Y').addEventListener('click',()=>{

        to_date = new Date();
        from_date = new Date();
        from_date = new Date(from_date.setFullYear( from_date.getFullYear() - 10 ));

        renderYear(from_date, to_date);
    });
    document.getElementById('filter25Y').addEventListener('click',()=>{

        to_date = new Date();
        from_date = new Date();
        from_date = new Date(from_date.setFullYear( from_date.getFullYear() - 25 ));

        renderYear(from_date, to_date);
    });
    document.getElementById('filterAll').addEventListener('click',()=>{

       to_date = new Date();
        from_date = new Date();
        from_date = new Date(from_date.setFullYear( from_date.getFullYear() - 100 ));

        renderYear(from_date, to_date);
    });


    // CSV export
    function toCsv(rows){
      const header = ['date','production_mmbl','price_usd','upstream_rev','midstream_rev','downstream_rev'];
      const lines = [header.join(',')];
      rows.forEach(r => lines.push([r[0],r[1],r[2],r[3],r[4],r[5]].join(',')));
      return lines.join('\n');
    }

    document.getElementById('exportCsv').addEventListener('click',()=>{
      const agg = aggregatesForYear(yearSelect.value);
      const csv = toCsv(agg.rows);
      const blob = new Blob([csv],{type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = `oil_gas_data_${yearSelect.value}.csv`; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }); 



  </script>
</body>
</html>
